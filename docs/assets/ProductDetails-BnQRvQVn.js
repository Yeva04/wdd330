import{a as i,s}from"./utils-B1gkA_s2.js";function d(r){if(r.ok)return r.json();throw new Error("Bad Response: ".concat(r.status," ").concat(r.statusText," for ").concat(r.url))}class c{constructor(t){this.category=t,this.path="/wdd330/json/".concat(this.category,".json"),this.fallbackData=[{Id:"880RR",Brand:{Name:"Marmot"},Name:"Marmot Ajax Tent - 3-Person, 3-Season",NameWithoutBrand:"Ajax Tent - 3-Person, 3-Season",ListPrice:199.99,FinalPrice:199.99,SuggestedRetailPrice:300,Image:"/wdd330/images/tents/marmot-ajax-tent-3-person-3-season-in-pale-pumpkin-terracotta~p~880rr_01~320.jpg",Colors:[{ColorName:"Pale Pumpkin/Terracotta"}],DescriptionHtmlSimple:"Get out and enjoy nature with Marmot's Ajax tent, featuring a smart design with durable, waterproof construction and two doors for easy access."},{Id:"985RF",Brand:{Name:"The North Face"},Name:"The North Face Talus Tent - 4-Person, 3-Season",NameWithoutBrand:"Talus Tent - 4-Person, 3-Season",ListPrice:199.99,FinalPrice:199.99,SuggestedRetailPrice:299,Image:"/wdd330/images/tents/the-north-face-talus-tent-4-person-3-season-in-golden-oak-saffron-yellow~p~985rf_01~320.jpg",Colors:[{ColorName:"Golden Oak/Saffron Yellow"}],DescriptionHtmlSimple:"<strong>Closeout</strong>. Enjoy a fun night under stars with your favorite people in The North Face's Talus four-person tent, featuring durable construction with a roomy interior, an advanced DAC Featherlite NSL pole system and an easy to pitch design."},{Id:"985PR",Brand:{Name:"The North Face"},Name:"The North Face Alpine Guide Tent - 3-Person, 4-Season",NameWithoutBrand:"Alpine Guide Tent - 3-Person, 4-Season",ListPrice:349.99,FinalPrice:349.99,SuggestedRetailPrice:489,Image:"/wdd330/images/tents/the-north-face-alpine-guide-tent-3-person-4-season-in-canary-yellow-high-rise-grey~p~985pr_01~320.jpg",Colors:[{ColorName:"Canary Yellow/High Rise Grey"}],DescriptionHtmlSimple:"<strong>Closeout</strong>. Be ready for any outdoor adventure in low elevations and high-alpine environments alike with the hybrid design of The North Face's Alpine Guide four-season tent. It is made from durable, waterproof nylon ripstop with an advanced DAC Featherlite NSL pole system and an easy to pitch design."},{Id:"344YJ",Brand:{Name:"Cedar Ridge"},Name:"Cedar Ridge Rimrock Tent - 2-Person, 3-Season",NameWithoutBrand:"Rimrock Tent - 2-Person, 3-Season",ListPrice:69.99,FinalPrice:69.99,SuggestedRetailPrice:89.99,Image:"/wdd330/images/tents/cedar-ridge-rimrock-tent-2-person-3-season-in-rust-clay~p~344yj_01~320.jpg",Colors:[{ColorName:"Rust/Clay"}],DescriptionHtmlSimple:"<strong>Closeouts</strong>. Lightweight and ready for adventure, this Cedar Ridge Rimrock tent boasts a weather-ready design that includes a tub-style floor and factory-sealed rain fly."}]}getData(){return console.log("Fetching: ".concat(this.path)),fetch(this.path).then(d).then(t=>(console.log("Fetched data:",t),t)).catch(t=>(console.error("Fetch error, using fallback data:",t),this.fallbackData))}async findProductById(t){const e=await this.getData();console.log("Products in findProductById:",e);const o=e.find(n=>n.Id===t);return o||console.warn("Product with ID ".concat(t," not found in data")),o||null}}class u{constructor(t){this.product=t}calculateDiscount(){const t=this.product.SuggestedRetailPrice||this.product.ListPrice,e=this.product.FinalPrice||this.product.ListPrice;if(t&&e&&t>e){const o=((t-e)/t*100).toFixed(0);return{discountPercentage:"".concat(o,"%"),originalPrice:"$".concat(t.toFixed(2)),discountedPrice:"$".concat(e.toFixed(2))}}return null}renderDiscount(){const t=this.calculateDiscount(),e=document.createElement("p");e.id="product-discount",t?e.innerHTML="Save <strong>".concat(t.discountPercentage,"</strong>! Was <s>").concat(t.originalPrice,"</s>, Now ").concat(t.discountedPrice):e.textContent="No discount available.";const o=document.getElementById("product-description");o?o.parentNode.insertBefore(e,o.nextSibling):console.error("product-description element not found")}}const a=i("product");console.log("Product ID from URL:",a);const l=new c("tents");class p{constructor(t,e){this.productId=t||"880RR",this.product={},this.dataSource=e}async init(){try{if(console.log("Initializing with productId:",this.productId),this.product=await this.dataSource.findProductById(this.productId),!this.product){console.error("Product not found for ID:",this.productId),document.querySelector(".product-detail").innerHTML="<p>Product not found. Please use ?product=880RR in the URL.</p>";return}console.log("Product loaded:",this.product),this.renderProductDetails(),this.addToCartButton(),this.applyDiscount()}catch(t){console.error("Error initializing ProductDetails:",t),document.querySelector(".product-detail").innerHTML="<p>Error loading product. Please try again later.</p>"}}addToCartButton(){const t=document.getElementById("addToCart");t?t.addEventListener("click",()=>{let e=localStorage.getItem("so-cart")?JSON.parse(localStorage.getItem("so-cart")):[];Array.isArray(e)||(e=[]);const o={...this.product,Id:this.product.Id};e.push(o),s("so-cart",e),console.log("Cart updated:",e),alert("Item added to cart!")}):console.error("addToCart button not found in DOM")}renderProductDetails(){var o,n;const t="/wdd330/";document.getElementById("product-brand").textContent=this.product.Brand.Name||"Unknown Brand",document.getElementById("product-name").textContent=this.product.NameWithoutBrand||this.product.Name||"Unnamed Product";const e=this.product.Image?"".concat(t,"images/tents/").concat(this.product.Image.split("/").pop()):"".concat(t,"images/noun_Tent_2517.svg");document.getElementById("product-image").src=e,document.getElementById("product-image").alt=this.product.Name||"Product Image",document.getElementById("product-price").textContent="$".concat(this.product.ListPrice||this.product.FinalPrice||0),document.getElementById("product-color").textContent=((n=(o=this.product.Colors)==null?void 0:o[0])==null?void 0:n.ColorName)||"N/A",document.getElementById("product-description").innerHTML=this.product.DescriptionHtmlSimple||"No description available",document.getElementById("addToCart").dataset.id=this.product.Id}applyDiscount(){new u(this.product).renderDiscount()}}const h=new p(a,l);h.init();export{p as P,c as a};
