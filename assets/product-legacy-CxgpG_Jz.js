System.register(["./utils-legacy-Cbk2QL-x.js","./ProductData-legacy-DnFEBNY4.js"],function(t,e){"use strict";var o,r,c;return{setters:[t=>{o=t.a,r=t.s},t=>{c=t.P}],execute:function(){class t{constructor(t){this.product=t}calculateDiscount(){const t=this.product.SuggestedRetailPrice||this.product.ListPrice,e=this.product.FinalPrice||this.product.ListPrice;return t&&e&&t>e?{discountPercentage:`${((t-e)/t*100).toFixed(0)}%`,originalPrice:`$${t.toFixed(2)}`,discountedPrice:`$${e.toFixed(2)}`}:null}renderDiscount(){const t=this.calculateDiscount(),e=document.createElement("p");e.id="product-discount",t?e.innerHTML=`Save <strong>${t.discountPercentage}</strong>! Was <s>${t.originalPrice}</s>, Now ${t.discountedPrice}`:e.textContent="No discount available.";const o=document.getElementById("product-description");o?o.parentNode.insertBefore(e,o.nextSibling):console.error("product-description element not found")}}const e=o("product");console.log("Product ID from URL:",e);const d=new c("tents");class n{constructor(t,e){this.productId=t||"880RR",this.product={},this.dataSource=e}async init(){try{if(console.log("Initializing with productId:",this.productId),this.product=await this.dataSource.findProductById(this.productId),!this.product)return console.error("Product not found for ID:",this.productId),void(document.querySelector(".product-detail").innerHTML="<p>Product not found. Please use ?product=880RR in the URL.</p>");console.log("Product loaded:",this.product),this.renderProductDetails(),this.addToCartButton(),this.applyDiscount()}catch(t){console.error("Error initializing ProductDetails:",t),document.querySelector(".product-detail").innerHTML="<p>Error loading product. Please try again later.</p>"}}addToCartButton(){const t=document.querySelector(".product-detail #addToCart");t?t.addEventListener("click",()=>{let t=localStorage.getItem("so-cart")?JSON.parse(localStorage.getItem("so-cart")):[];Array.isArray(t)||(t=[]);const e={...this.product,Id:this.product.Id};t.push(e),r("so-cart",t),console.log("Cart updated:",t),alert("Item added to cart!")}):console.error("addToCart button not found in DOM")}renderProductDetails(){const e="/wdd330/",o=document.querySelector(".product-detail");if(!o)return void console.error("Product detail section not found");const r=o.querySelector("#product-brand"),c=o.querySelector("#product-name"),d=o.querySelector("#product-image"),n=o.querySelector("#product-price"),i=o.querySelector("#product-color"),u=o.querySelector("#product-description"),s=o.querySelector("#product-discount"),a=o.querySelector("#addToCart");if(r&&(r.textContent=this.product.Brand.Name||"Unknown Brand"),c&&(c.textContent=this.product.NameWithoutBrand||this.product.Name||"Unnamed Product"),d){const t=this.product.Image?`${e}images/tents/${this.product.Image.split("/").pop()}`:`${e}images/noun_Tent_2517.svg`;d.src=t,d.alt=this.product.Name||"Product Image"}n&&(n.textContent=`$${this.product.ListPrice||this.product.FinalPrice||0}`),i&&(i.textContent=this.product.Colors?.[0]?.ColorName||"N/A"),u&&(u.innerHTML=this.product.DescriptionHtmlSimple||"No description available"),s&&new t(this.product).renderDiscount(),a&&(a.dataset.id=this.product.Id)}applyDiscount(){document.querySelector(".product-detail #product-discount")?new t(this.product).renderDiscount():console.error("Discount element not found")}}new n(e,d).init();const i=o("product");i?new n(i,new c("tents")).init():(console.error("No product ID in URL parameters"),document.querySelector(".product-detail").innerHTML="<p>No product selected. Please use a valid URL (e.g., ?product=880RR).</p>")}}});
