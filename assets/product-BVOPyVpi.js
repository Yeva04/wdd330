import{a as g,s as I}from"./utils-B1gkA_s2.js";import{P}from"./ProductData-DRfcUAi5.js";function q(){import.meta.url,import("_").catch(()=>1),(async function*(){})().next()}class m{constructor(o){this.product=o}calculateDiscount(){const o=this.product.SuggestedRetailPrice||this.product.ListPrice,t=this.product.FinalPrice||this.product.ListPrice;if(o&&t&&o>t){const e=((o-t)/o*100).toFixed(0);return{discountPercentage:"".concat(e,"%"),originalPrice:"$".concat(o.toFixed(2)),discountedPrice:"$".concat(t.toFixed(2))}}return null}renderDiscount(){const o=this.calculateDiscount(),t=document.createElement("p");t.id="product-discount",o?t.innerHTML="Save <strong>".concat(o.discountPercentage,"</strong>! Was <s>").concat(o.originalPrice,"</s>, Now ").concat(o.discountedPrice):t.textContent="No discount available.";const e=document.getElementById("product-description");e?e.parentNode.insertBefore(t,e.nextSibling):console.error("product-description element not found")}}const f=g("product");console.log("Product ID from URL:",f);const D=new P("tents");class S{constructor(o,t){this.productId=o||"880RR",this.product={},this.dataSource=t}async init(){try{if(console.log("Initializing with productId:",this.productId),this.product=await this.dataSource.findProductById(this.productId),!this.product){console.error("Product not found for ID:",this.productId),document.querySelector(".product-detail").innerHTML="<p>Product not found. Please use ?product=880RR in the URL.</p>";return}console.log("Product loaded:",this.product),this.renderProductDetails(),this.addToCartButton(),this.applyDiscount()}catch(o){console.error("Error initializing ProductDetails:",o),document.querySelector(".product-detail").innerHTML="<p>Error loading product. Please try again later.</p>"}}addToCartButton(){const o=document.querySelector(".product-detail #addToCart");o?o.addEventListener("click",()=>{let t=localStorage.getItem("so-cart")?JSON.parse(localStorage.getItem("so-cart")):[];Array.isArray(t)||(t=[]);const e={...this.product,Id:this.product.Id};t.push(e),I("so-cart",t),console.log("Cart updated:",t),alert("Item added to cart!")}):console.error("addToCart button not found in DOM")}renderProductDetails(){var a,l;const o="/wdd330/",t=document.querySelector(".product-detail");if(!t){console.error("Product detail section not found");return}const e=t.querySelector("#product-brand"),n=t.querySelector("#product-name"),c=t.querySelector("#product-image"),i=t.querySelector("#product-price"),d=t.querySelector("#product-color"),s=t.querySelector("#product-description"),y=t.querySelector("#product-discount"),u=t.querySelector("#addToCart");if(e&&(e.textContent=this.product.Brand.Name||"Unknown Brand"),n&&(n.textContent=this.product.NameWithoutBrand||this.product.Name||"Unnamed Product"),c){const p=this.product.Image?"".concat(o,"images/tents/").concat(this.product.Image.split("/").pop()):"".concat(o,"images/noun_Tent_2517.svg");c.src=p,c.alt=this.product.Name||"Product Image"}i&&(i.textContent="$".concat(this.product.ListPrice||this.product.FinalPrice||0)),d&&(d.textContent=((l=(a=this.product.Colors)==null?void 0:a[0])==null?void 0:l.ColorName)||"N/A"),s&&(s.innerHTML=this.product.DescriptionHtmlSimple||"No description available"),y&&new m(this.product).renderDiscount(),u&&(u.dataset.id=this.product.Id)}applyDiscount(){document.querySelector(".product-detail #product-discount")?new m(this.product).renderDiscount():console.error("Discount element not found")}}const C=new S(f,D);C.init();const h=g("product");if(!h)console.error("No product ID in URL parameters"),document.querySelector(".product-detail").innerHTML="<p>No product selected. Please use a valid URL (e.g., ?product=880RR).</p>";else{const r=new P("tents");new S(h,r).init()}export{q as __vite_legacy_guard};
